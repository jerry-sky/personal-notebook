<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-GB" xml:lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jerry Sky" />
  <meta name="keywords" content="Angular, TypeScript, node, Router, htaccess, observable, file, model, app, program, npm" />
  <meta name="description" content="Notes on Angular (non JS)." />
  <title>Angular Notes</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="/style.css" />
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Merriweather&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@500&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
</head>
<body>
<header id="title-block-header">
<h1 class="title">Angular Notes</h1>
<p class="author">
    <span>by </span>
    <span class="author">Jerry Sky</span>
</p>
</header>
<p id="document-description"><em>Notes on Angular (non JS).</em></p>
<hr />
<ul>
<li><a href="#resources">Resources</a></li>
<li><a href="#installing-bootstrap">Installing Bootstrap</a></li>
<li><a href="#ngmodel-input-element-inside-ngfor">NgModel input element inside ngFor</a></li>
<li><a href="#router-vs-location"><code>Router</code> vs. <code>Location</code></a></li>
<li><a href="#ending-an-observable">Ending an <code>Observable</code></a></li>
<li><a href="#upload-progress">Upload progress</a></li>
<li><a href="#the-htaccess-file">The <code>.htaccess</code> file</a></li>
<li><a href="#tracking-many-files">Tracking many files</a></li>
<li><a href="#testing-components-that-contain-angular-material-components">Testing components that contain Angular Material components</a></li>
<li><a href="#using-anchor-links">Using anchor links</a></li>
<li><a href="#using-svg-icons-with-angular-material">Using SVG icons with Angular Material</a></li>
</ul>
<hr />
<h2 id="resources">Resources</h2>
<ul>
<li><a href="https://alligator.io/angular/">Alligator.io</a></li>
</ul>
<hr />
<h2 id="installing-bootstrap">Installing Bootstrap</h2>
<ol type="1">
<li><div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>   <span class="ex">npm</span> install bootstrap</span></code></pre></div></li>
<li><p>Modify <code>$WORKING_DIRECTORY/angular.json</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;styles&quot;:</span> <span class="ot">[</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;node_modules/bootstrap/dist/css/bootstrap.min.css&quot;</span><span class="ot">,</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;styles.css&quot;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div></li>
</ol>
<hr />
<h2 id="ngmodel-input-element-inside-ngfor">NgModel input element inside ngFor</h2>
<p>Nested <code>ngModel</code> input element inside <code>ngFor</code> need to refer to a value inside an <code>Object</code>. If it isn’t wrapped in an <code>Object</code> Angular won’t compile the app for some odd reason.</p>
<hr />
<h2 id="router-vs-location"><code>Router</code> vs. <code>Location</code></h2>
<p>When using Angular navigation use the <code>Router</code>’s <code>navigate</code> function. The <code>Location</code>’s <code>go</code> function is meant to interact with URL, not to navigate in application routes.</p>
<p><a href="https://stackoverflow.com/a/42858854/4249875">Source</a></p>
<hr />
<h2 id="ending-an-observable">Ending an <code>Observable</code></h2>
<p>To complete the <code>Observable</code> use <code>return of()</code>. It will stop propagating any further notifications as <code>of</code> with no arguments will complete right away and not emit any notifications.</p>
<hr />
<h2 id="upload-progress">Upload progress</h2>
<p>To get notifications about a file being uploaded use <code>reportProgress: true</code> in any <code>HTTP</code> method’s additional options object.</p>
<p><a href="https://stackoverflow.com/a/54899930/4249875">Source</a></p>
<hr />
<h2 id="the-htaccess-file">The <code>.htaccess</code> file</h2>
<p>For serving a static Angular app on a standard Apache server you need to setup a <code>.htaccess</code> file <a href="general#corb--cors">like so</a>.</p>
<p><a href="https://stackoverflow.com/a/22740184/4249875">Source</a></p>
<hr />
<h2 id="tracking-many-files">Tracking many files</h2>
<p>When dealing with multiple Angular projects or Angular projects mixed with some other opened at once the system can be overwhelmed with the amount of files to track as the code editor is trying to observe every single file in all of the projects. The solution seems to be to alter a default number of files the system is allowed to track.</p>
<!-- spell-checker: disable-next-line -->
<ol type="1">
<li>Open <code>/etc/sysctl.conf</code> and add line <code>fs.inotify.max_user_watches=524288</code>. <!-- spell-checker: disable-next-line --></li>
<li>Execute <code>sudo sysctl -p</code>. <!-- spell-checker: disable-next-line --></li>
<li>View <code>/proc/sys/fs/inotify/max_user_watches</code> and verify that the output number equals to <code>524288</code>.</li>
</ol>
<hr />
<h2 id="testing-components-that-contain-angular-material-components">Testing components that contain Angular Material components</h2>
<p>When testing a component with some components from Angular Material (e.g. <code>MatButton</code> or <code>MatCard</code>) you have to include appropriate Angular Material modules to your tests.<br />
For example, when the component contains a <code>mat-button</code> you should add to the <code>imports</code> of the test a reference to the <code>MatButtonModule</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">beforeEach</span>(<span class="fu">async</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    TestBed<span class="op">.</span><span class="fu">configureTestingModule</span>({</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        imports<span class="op">:</span> [</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>            MatButtonModule<span class="op">,</span> <span class="co">// said reference</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        ]<span class="op">,</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        declarations<span class="op">:</span> [</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            <span class="op">...</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        ]<span class="op">,</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    })<span class="op">.</span><span class="fu">compileComponents</span>()<span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>}))<span class="op">;</span></span></code></pre></div>
<p>otherwise, the test will complain about unidentifiable components.</p>
<p>Secondly, if it is necessary to test the interaction with an Angular Material component (instead of e.g. testing only the function that is invoked by this component) it is advised to use Angular Material’s component harnesses. This method prevents from possible issues due to change in the internal API of Angular Material.</p>
<blockquote>
<p><em>“Relying on implementation details of third party libraries<em> </em>is cumbersome because you are vulnerable to refactorings,<em> </em>and you need to understand implementation details.”</em></p>
</blockquote>
<p>Instead of accessing the components in the HTML through invoking the <code>query</code> method use mentioned earlier Angular Material’s component harnesses.</p>
<p>Setup:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>let loader<span class="op">:</span> HarnessLoader<span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>let component<span class="op">:</span> [<span class="op">...</span>]<span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">beforeEach</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    fixture <span class="op">=</span> TestBed<span class="op">.</span><span class="fu">createComponent</span>([<span class="op">...</span>])<span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    component <span class="op">=</span> fixture<span class="op">.</span><span class="at">componentInstance</span><span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    loader <span class="op">=</span> TestBedHarnessEnvironment<span class="op">.</span><span class="fu">loader</span>(fixture)<span class="op">;</span> <span class="co">// (1)</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    fixture<span class="op">.</span><span class="fu">detectedChanges</span>()<span class="op">;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Here we are preparing the <code>TestBed</code> for our testing purposes. Notice the <code>(1)</code> additional line that loads the harness environment.</p>
<p>Now we can test Angular Material components. Here is an example from the <a href="https://medium.com/@kevinkreuzer/test-your-components-using-angular-materials-component-harnesses-f9c1deebdf5d">source article</a>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">it</span>(<span class="st">&#39;should filter out the alive characters if we set filter to dead&#39;</span><span class="op">,</span> <span class="fu">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    const deadRadioButton <span class="op">=</span> await loader<span class="op">.</span><span class="fu">getHarness</span><span class="op">&lt;</span>MatRadioButtonHarness<span class="op">&gt;</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        MatRadioButtonHarness<span class="op">.</span><span class="fu">with</span>({</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>            label<span class="op">:</span> <span class="st">&#39;Dead&#39;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    const table <span class="op">=</span> await loader<span class="op">.</span><span class="fu">getHarness</span><span class="op">&lt;</span>MatTableHarness<span class="op">&gt;</span>(MathTableHarness)<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    await deadRadioButton<span class="op">.</span><span class="fu">check</span>()<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    const rows <span class="op">=</span> await table<span class="op">.</span><span class="fu">getRows</span>()<span class="op">;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expect</span>(rows<span class="op">.</span><span class="at">length</span>)<span class="op">.</span><span class="fu">toBe</span>(<span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<p>Sources:</p>
<ul>
<li><a href="https://material.angular.io/guide/using-component-harnesses">Angular Material guide on component harnesses</a></li>
<li><a href="https://medium.com/@kevinkreuzer/test-your-components-using-angular-materials-component-harnesses-f9c1deebdf5d">The original article on Medium by Kevin Kreuzer</a></li>
</ul>
<hr />
<h2 id="using-anchor-links">Using anchor links</h2>
<p>Angular has the anchor links disabled by default (at least when the routing is enabled).</p>
<p>Refactoring the module responsible for routing in a given app as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>[<span class="op">...</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>const routerOptions<span class="op">:</span> ExtraOptions <span class="op">=</span> {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    useHash<span class="op">:</span> false<span class="op">,</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    anchorScrolling<span class="op">:</span> <span class="st">&#39;enabled&#39;</span><span class="op">,</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>@<span class="fu">NgModule</span>({</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    imports<span class="op">:</span> [RouterModule<span class="op">.</span><span class="fu">forRoot</span>(routes<span class="op">,</span> routerOptions)]<span class="op">,</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    exports<span class="op">:</span> [RouterModule]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>export class AppRoutingModule { }</span></code></pre></div>
<p>will enable this functionality.</p>
<p>Source: <a href="https://stackoverflow.com/a/52724769/4249875">an answer on Stack Overflow</a></p>
<hr />
<h2 id="using-svg-icons-with-angular-material">Using SVG icons with Angular Material</h2>
<p>To add a custom SVG icon that can be used throughout the whole app you need to import <code>MatIconRegistry</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { MatIconRegistry } from <span class="st">&quot;@angular/material/icon&quot;</span><span class="op">;</span></span></code></pre></div>
<p>and the <code>DomSanitizer</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { DomSanitizer } from <span class="st">&quot;@angular/platform-browser&quot;</span><span class="op">;</span></span></code></pre></div>
<p>to resolve the path by trusting the local asset file.</p>
<p>Then, inside of <code>app.module.ts</code> inject said dependencies into the class constructor and add the desired icon(s) to the registry:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constructor</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    private MIR<span class="op">:</span> MatIconRegistry<span class="op">,</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    private DS<span class="op">:</span> DomSanitizer</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    this<span class="op">.</span><span class="at">MIR</span><span class="op">.</span><span class="fu">addSvgIcon</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;custom_icon&#39;</span><span class="op">,</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        this<span class="op">.</span><span class="at">DS</span><span class="op">.</span><span class="fu">bypassSecurityTrustResourceUrl</span>(<span class="st">&quot;assets/custom-icon.svg&quot;</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Source: <a href="https://www.digitalocean.com/community/tutorials/angular-custom-svg-icons-angular-material">Digital Ocean Article</a></p>
<hr />
</body>
</html>
